%! Author = jgilmer19
%! Date = 1/28/20

% Preamble
\documentclass[11pt]{article}

% Packages
\usepackage{amsmath}

% Document
\begin{document}
    \noindent John Gilmer \\
    \noindent SDS 383 D - Statistical Modeling 2 \\
    \noindent Homework \\

    \noindent\textbf{Exercise 1}

    \(X_1, \dots X_n \sim Bernoulli(p), \quad h(p) \sim Beta(\alpha, \beta)\)

    \begin{align*}
        p | X_1, \dots X_N \propto& f(x_1, \dots x_n |p) \cdot h(p) \\
        \propto&  p^{\sum x_i} (1 - p)^{n- \sum x_i} \cdot p^{\alpha - 1} (1 - p) ^{\beta - 1} \\
        \propto&  p^{\sum x_i + \alpha - 1} (1 - p)^{\beta + n - \sum x_i - 1}
    \end{align*}

    \begin{align*}
      p | X_1, \dots X_N \sim Beta(\sum x_i + \alpha, \beta + n - \sum x_i)
    \end{align*}
    \\

    \noindent\textbf{Exercise 2} \\ \\
    \(X_1, \dots X_N \stackrel{iid}{\sim} Cat(p), \quad p = (p_1, \dots p_K), \quad
       f(x | p) = \prod_{i=1}^{n} \prod_{k=1}^{K} p_k ^{I(x_i = k)}\) \\
    \( p \sim Dirichlet(\alpha_1, \dots \alpha_K)\) \\
    \begin{equation*}
    \pi(p) = \frac{\Gamma (\sum_k \alpha_k)}{\prod_K \Gamma(\alpha_k)} \prod_{k=1}^{K}
        p^{\alpha_k - 1} \mdot I(\sum_{k=1}^{K-1} p_k \leq 1, p_k \geq 0)
    \end{equation*}

    \begin{align*}
        p | X_{1:n} \propto& f(x_{1:n} | p) \cdot \pi(p) \\
        \propto& \prod_{i=1} ^{n} \prod_{k=1}^K p_k ^{I(x_i = k)} \cdot \prod_{k=1}^{K} p_k^{\alpha_k -1} \\
        \propto & \prod_{k=1}^K p_K ^{n_k + \alpha_k -1}, \quad \text{where }n_k = \sum_{i=1}^{N} I(x_i = k) \\
        p | X_{1:n} \sim& Dir(n_1 + \alpha_1, \dots n_k + \alpha_k)
    \end{align*}




\end{document}